<html lang="en">

<head>
    <title>Sign pdf</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />
    <link
        rel="stylesheet"
        href="/App.css"
      />
</head>

<body>
    <div class="container">
        <h1 class="text-center">
            Sign your Pdf
        </h1>
        <progress id="uploader" value="0" max="100">0%</progress>
        <input type="file" id="fileButton" value="upload" />
        <div id="adobe-dc-view"></div>
        <div id="test"></div>
    </div>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/3.7.4/firebase.js"></script>
<script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>


<script>

    var firebaseConfig = {
        apiKey: "AIzaSyBFX2SorFb0KkjS98it6p95XBSrwv282cg",
        authDomain: "medios-60b59.firebaseapp.com",
        databaseURL: "https://medios-60b59.firebaseio.com",
        projectId: "medios-60b59",
        storageBucket: "medios-60b59.appspot.com",
        messagingSenderId: "38496733526",
        appId: "1:38496733526:web:25b05b0ac17cf99a67eef7",
        measurementId: "G-SLRJ9M543W"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    var uploader = document.getElementById('uploader');
    var fileButton = document.getElementById('fileButton');
    fileButton.addEventListener('change', function (e) {
        var file = e.target.files[0];
        const name = (+new Date()) + '-' + file.name;
        const metadata = {
            contentType: file.type
        };
        var storageRef = firebase.storage().ref();
        var task = storageRef.child(name).put(file, metadata);
        task.on('state_changed', function progress(snapshot) {
            var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
            uploader.value = percentage;

        })
        task
            .then(snapshot => snapshot.ref.getDownloadURL())
            .then((url) => {
                console.log(url)
                document.getElementById("test").innerHTML = url;
                var adobeDCView = new AdobeDC.View({
                    clientId: "db19cfbe88344638a8afd9145f16fe1b",
                    divId: "adobe-dc-view"
                });
                adobeDCView.previewFile({
                    content: { location: { url: url } },
                    metaData: { fileName: "url+test" }
                }, {
                    embedMode: "IN_LINE",
                    showDownloadPDF: false,
                    showPrintPDF: false
                });
            })
            .catch(console.error);
    })

</script>

</html>